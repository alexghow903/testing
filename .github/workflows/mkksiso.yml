---
name: Modify Image
on: workflow_dispatch

env:
  IMAGE_NAME: "bazzite-bc250"  # the name of the image produced by this build, matches repo names
  IMAGE_DESC: "A custom Fedora image for the AMD BC-250"
  IMAGE_REGISTRY: "ghcr.io/${{ github.repository_owner }}"  # do not edit

jobs:
  build_push:
    name: Build and push image
    runs-on: ubuntu-latest
    # container:
    #   image: fedora:latest
    #   # --privileged needed for livemedia-creator
    #   options: --privileged

    steps:
      - name: checkout
        uses: actions/checkout@v3
        
      - name: Install Lorax
        run: git clone https://github.com/weldr/lorax.git && cd lorax && sudo make && sudo make install

      # - name: Install Lorax
      #   run: dnf install -y zstd lorax lorax-lmc-novirt anaconda pykickstart dracut-live
    
      - name: Create the custom ISO
        run: |
          sudo livemedia-creator \
            --ks BC-250.ks \
            --no-virt \
            --make-iso \
            --iso-only \
            --iso-name BC-250.iso \
            --resultdir ./Results

    
